<!DOCTYPE html>
<html lang="es">
<head>
    <title>Paypal + NUVEI</title>
    <link rel="icon" href="https://docs.nuvei.com/wp-content/themes/manual-child/img/favicons/cropped-favicon-nuvei-32x32.png" sizes="32x32">
    <meta charset="UTF-8">
    <meta name="title" content="Test Nuvei">
    <meta name="description" content="Descripción de la WEB">
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://www.paypal.com/sdk/js?client-id=AXsloLh0BwpApDZGmfOdWKiTxlyHi4dLQ63gpsHK1Son0cXtq657wRakklBo29Ja6XKuuih3W3YlVD0r"></script>
    <body>
        <div id="paypal-button-container"></div>
    <script>
        paypal.Buttons({
  createOrder: function () {
    return fetch("/.netlify/functions/create-nuvei-order", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ amount: 100, currency: "USD" })
    })
    .then(res => res.json())
    .then(data => data.transactionBankId);
  },

  onApprove: function () {
    return fetch("https://test.safecharge.com/APMNotificationGateway/ApmConnectorNotify/Connector/64/727", {
      method: "POST"
    })
    .then(res => res.text())
    .then(result => console.log("Notificación enviada a Nuvei:", result))
    .catch(err => console.error("Error en onApprove:", err));
  },

  onError: function (err) {
    console.error("PayPal error", err);
  }
}).render('#paypal-button-container');


    </script>
    </body>  
</html>

